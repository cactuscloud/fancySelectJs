function fancySelectJs(t){this.DELIMITER=",",this.select=null,this.selectText=null,this.dropdown=null,this.template=null,this.parent=null,this.multiple=!1,this.disabled=!1,this.length=0,this.options=[],this.values=[],this.selectedIndices=[],this.frameRequested=!1,this.dropdownTop,this.dropdownLeft,this.dropdownWidth,this.dropdownVisible=!1,this.mouseY,this.mouseX,this.searchString="",this.searchTimer,this.initializing=!1,this.initialized=!1,this.hoverIndex=0,this.placeholder="",this.multiplePlaceholder="Multiple Values",this.allPlaceholder="All",this.prefixText=null,this.allIndex=null,this.allIndexSelected=!1,"undefined"!=typeof t&&t&&this.init(t),this.onchange=null}Array.prototype.includes||(Array.prototype.includes=function(t){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");var e=Object(this),i=parseInt(e.length,10)||0;if(0===i)return!1;var s,n=parseInt(arguments[1],10)||0;n>=0?s=n:(s=i+n,0>s&&(s=0));for(var l;i>s;){if(l=e[s],t===l||t!==t&&l!==l)return!0;s++}return!1}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var i;if(null==this)throw new TypeError('"this" is null or not defined');var s=Object(this),n=s.length>>>0;if(0===n)return-1;var l=+e||0;if(1/0===Math.abs(l)&&(l=0),l>=n)return-1;for(i=Math.max(l>=0?l:n-Math.abs(l),0);n>i;){if(i in s&&s[i]===t)return i;i++}return-1}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),fancySelectJs.prototype.init=function(t){if(!this.initialized){if(this.initializing=!0,"undefined"==typeof t||!t)throw new TypeError("fancySelectJs requires a valid HTML SELECT element to initialize.");if("string"==typeof t&&(t=document.getElementById(t)),"undefined"==typeof t.tagName||!t.tagName)throw new TypeError("fancySelectJs requires a valid HTML SELECT element to initialize.");if(null!=t.fancySelectJs)throw new Error("A fancySelectJs already exists for this element");this.template=t,this.placeholder=t.getAttribute("data-placeholder")||"",this.prefixText=t.getAttribute("data-prefix")||null,this.multiple=t.multiple,t.oldSize=t.size,t.size=1;var e=[];e=fancySelectJs.parseData(t.hasAttribute("data-value")?t.getAttribute("data-value"):$(t).val()),null==e&&(e=[]);for(var i,s,n,l=t.children,o=0,h=l.length;h>o;o++)i=l[o],this.multiple&&i.hasAttribute("data-all")&&(this.allIndex=o),s=i.getAttribute("value").trim(),n={value:s,label:l[o].innerHTML.trim()},this.options.push(n),e.includes(s)&&(this.values.push(n),this.selectedIndices.push(o),this.allIndex==o&&(this.allIndexSelected=!0));t.hasAttribute("data-all-index")&&(this.allIndex=parseInt(t.getAttribute("data-all-index")));var r=document;if(t.hasAttribute("data-scroll-parent")){var d=r.getElementById(t.getAttribute("data-scroll-parent"));this.parent="undefined"!=typeof d&&null!=d?d:r.body}else this.parent=r.body;this.buildGui(t),this.setEventListeners(),this.updateValues(),1==this.values.length&&(this.hoverIndex=this.selectedIndices[0]),t.disabled&&this.disable(),$(t).hide(),t.parentElement.insertBefore(this.select,t),this.parent.appendChild(this.dropdown),t.fancySelectJs=this,this.initializing=!1,this.initialized=!0}},fancySelectJs.prototype.buildGui=function(t){if(!this.initialized){var e=document,i=e.createElement("div");i.className="fancySelectJs "+t.className,i.display=$(t).css("display"),i.style.display=$(t).css("display"),i.style.opacity=$(t).css("opacity"),i.setAttribute("role","listbox"),t.hasAttribute("data-id")&&(i.id=t.getAttribute("data-id"));var s=e.createElement("div");s.className="select",s.tabIndex=0,s.style.lineHeight=$(t).outerHeight()+"px",s.style.height=$(t).css("height"),i.appendChild(s);var n=e.createElement("div");n.className="fancySelectJs_dropdown",this.multiple&&n.setAttribute("data-multiple","true");for(var l=t.children,o="",h=0,r=l.length;r>h;h++)o+=this.multiple?'<div role="option" class="option check" aria-checked="false">'+l[h].innerHTML+"</div>":'<div role="option" class="option" aria-selected="false">'+l[h].innerHTML+"</div>";n.innerHTML=o,this.selectText=s,this.select=i,this.dropdown=n}},fancySelectJs.prototype.setEventListeners=function(){this.initialized||($(window).on("resize orientationchange",this.queuePositionDropdown.bind(this)),$(this.template).closest("form").on("reset",this.reset.bind(this)),$(this.select).on("click",this.selectClick.bind(this)),$(this.selectText).on("blur",this.blur.bind(this)),$(this.selectText).on("keydown",this.keydown.bind(this)),$(this.dropdown).on("mousedown",this.dropdownMousedown.bind(this)),$(this.dropdown.children).on("click",this.optionClick.bind(this)),$(this.dropdown.children).on("mousemove",this.optionHover.bind(this)),$(document).one("ready",{fireChangeEvent:!1},this.updateValues.bind(this)))},fancySelectJs.prototype.destroy=function(){try{this.template.fancySelectJs=null}catch(t){}try{this.initialized=!1,this.initializing=!1,this.allIndexSelected=!1,clearTimeout(this.searchTimer),this.dropdown.innerHTML="",this.select.innerHTML="",this.dropdown.parentNode.removeChild(this.dropdown),this.select.parentNode.removeChild(this.select)}catch(t){}try{this.template.size=this.template.oldSize,$(this.template).show()}catch(t){}try{this.onchange=null,this.select=null,this.selectText=null,this.dropdown=null,this.template=null,this.parent=null,this.options=null,this.values=null,this.selectedIndices=null}catch(t){}},fancySelectJs.prototype.updateValues=function(t){if(this.initializing||this.initialized){(this.allIndexSelected||null!=this.allIndex&&0==this.values.length)&&(this.values=[],this.selectedIndices=[],this.values.push(this.options[this.allIndex]),this.selectedIndices.push(this.allIndex),this.allIndexSelected=!0);for(var e,i=this.dropdown.children,s=0,n=i.length;n>s;s++)e=i[s],e.removeAttribute("data-hover"),this.selectedIndices.includes(s)?(e.setAttribute("data-selected","true"),this.multiple?e.setAttribute("aria-checked","true"):e.setAttribute("aria-selected","true")):(e.removeAttribute("data-selected"),this.multiple?e.setAttribute("aria-checked","false"):e.setAttribute("aria-selected","false"));var l=this.selectedIndices.length;if(0==l)this.selectText.innerHTML=this.placeholder,this.selectText.setAttribute("data-placeholder","true");else{var o=this.prefixText?'<span class="prefix">'+this.prefixText+"</span>&nbsp;":"";this.selectText.removeAttribute("data-placeholder"),this.selectText.innerHTML=1==l?o+this.values[0].label:l==i.length?o+this.allPlaceholder:this.multiplePlaceholder}if(this.allIndexSelected){this.values=[],this.selectedIndices=[];for(var s=0,n=this.options.length;n>s;s++)s!=this.allIndex&&(this.values.push(this.options[s]),this.selectedIndices.push(s))}for(var h=[],s=0,n=this.values.length;n>s;s++)h.push(this.values[s].value);$(this.template).val(h),this.initialized!==!0||"undefined"!=typeof t&&t.data&&t.data.fireChangeEvent===!1||(this.fireEvent("change"),"function"==typeof this.onchange&&this.onchange())}},fancySelectJs.prototype.fireEvent=function(t){var e=document.createEvent("HTMLEvents");e.initEvent(t,!0,!0),this.template.dispatchEvent(e)},fancySelectJs.prototype.selectIndex=function(t){if(this.initialized){if(this.multiple){if(this.allIndexSelected&&this.allIndex==t)return;this.allIndexSelected&&(this.values=[],this.selectedIndices=[]),this.allIndexSelected=this.allIndex==t;var e=this.selectedIndices.indexOf(t);-1==e?(this.values.push(this.options[t]),this.selectedIndices.push(t)):(this.selectedIndices.splice(e,1),this.values.splice(e,1))}else this.values=[],this.selectedIndices=[],this.values.push(this.options[t]),this.selectedIndices.push(t);this.hoverIndex=t,this.updateValues()}},fancySelectJs.prototype.optionClick=function(t){this.initialized&&(this.selectIndex($(t.target).index()),this.multiple||this.hideDropdown())},fancySelectJs.prototype.optionHover=function(t){if(this.initialized&&(this.mouseX!==t.clientX||this.mouseY!==t.clientY)){if(this.mouseX=t.clientX,this.mouseY=t.clientY,t.target.hasAttribute("data-hover"))return;this.highlightIndex($(t.target).index())}},fancySelectJs.prototype.keydown=function(t){if(this.initialized&&!this.disabled&&0!=this.options.length){var e=t.keyCode;if(this.dropdownVisible&&(e>47&&58>e||e>64&&91>e||e>95&&106>e)){clearTimeout(this.searchTimer),this.searchString+=String.fromCharCode(e);for(var i=-1,s=0,n=this.options.length;n>s;s++)if(this.options[s].label.toUpperCase().replace(/\s/,"").startsWith(this.searchString)){i=s;break}if(this.searchTimer=setTimeout(this.resetSearchString.bind(this),800),-1===i)return;return this.multiple?this.highlightIndex(i):this.selectIndex(i),void this.scrollOptionIntoView(i)}return 32==e?(t.preventDefault(),void(this.dropdownVisible&&null!=this.hoverIndex&&this.selectIndex(this.hoverIndex))):13==e?void(this.dropdownVisible&&(this.hideDropdown(),t.preventDefault())):27==e?void(this.dropdownVisible&&(this.hideDropdown(),t.preventDefault())):40==e||38==e?void(this.dropdownVisible&&(40==e?null==this.hoverIndex?this.hoverIndex=this.options.length-1:this.hoverIndex++:null==this.hoverIndex?this.hoverIndex=0:this.hoverIndex--,this.hoverIndex<0?this.hoverIndex=this.options.length-1:this.hoverIndex>=this.options.length&&(this.hoverIndex=0),this.multiple?this.highlightIndex(this.hoverIndex):this.selectIndex(this.hoverIndex),this.scrollOptionIntoView(this.hoverIndex),t.preventDefault())):void 0}},fancySelectJs.prototype.resetSearchString=function(){this.initialized&&(clearTimeout(this.searchTimer),this.searchString="")},fancySelectJs.prototype.blur=function(){return this.initialized?document.activeElement===this.DOM_dropdown?void e.target.focus():void this.hideDropdown():void 0},fancySelectJs.prototype.dropdownMousedown=function(t){this.initialized&&t.preventDefault()},fancySelectJs.prototype.selectClick=function(t){this.initialized&&!this.disabled&&$(t.target).hasClass("select")&&this.toggleDropdown()},fancySelectJs.prototype.reset=function(){this.initialized&&(this.selectedIndices=[],this.values=[],this.updateValues())},fancySelectJs.prototype.setValue=function(t){if((this.initialized||this.initializing)&&(this.selectedIndices=[],this.values=[],this.allIndexSelected=!1,("string"==typeof t||"object"==typeof t)&&null!=t&&""!=t)){var e,i=fancySelectJs.parseData(t,this.DELIMITER);if(!Array.isArray(i))throw new TypeError("fancySelectJs.setValue requires either a string or an array to function");for(var s=0,n=this.options.length;n>s;s++)e=this.options[s],i.includes(e.value.trim())&&(this.selectedIndices.push(s),this.values.push(e));this.initialized&&this.updateValues()}},fancySelectJs.parseData=function(t,e){if(("undefined"==typeof e||e)&&(e=","),"string"==typeof t){t=t.trim();var i=t.substr(0,1),s=t.substr(t.length-1,1);if("["==i&&"]"==s||"("==i&&")"==s)var n=t.substr(1,t.length-2).split(e);else n=t.split(e);for(var l=0,o=n.length;o>l;l++)n[l]=n[l].trim();return n}return Array.isArray(t)?t:null},fancySelectJs.prototype.getValue=function(){return this.initialized?$(this.template).val():void 0},fancySelectJs.prototype.disable=function(){this.initialized&&(this.disabled=!0,this.select.setAttribute("data-disabled","true"),this.select.tabIndex=-1,this.hideDropdown(),this.template.disabled=!0)},fancySelectJs.prototype.enable=function(){this.initialized&&(this.disabled=!1,this.select.removeAttribute("data-disabled"),this.select.tabIndex=0,this.template.disabled=!1)},fancySelectJs.prototype.highlightIndex=function(t){if(this.initialized)for(var e,i=this.dropdown.children,s=0,n=i.length;n>s;s++)e=i[s],s==t?(e.setAttribute("data-hover","true"),this.hoverIndex=s):e.removeAttribute("data-hover")},fancySelectJs.prototype.showDropdown=function(){this.initialized&&(this.dropdownVisible||(this.queuePositionDropdown(),this.select.setAttribute("data-dropdown","visible"),this.dropdown.setAttribute("data-visible","true"),this.dropdownVisible=!0))},fancySelectJs.prototype.hideDropdown=function(){this.initialized&&this.dropdownVisible&&(this.select.removeAttribute("data-dropdown"),this.dropdown.removeAttribute("data-visible"),this.dropdownVisible=!1)},fancySelectJs.prototype.toggleDropdown=function(){this.initialized&&(this.dropdownVisible?this.hideDropdown():this.showDropdown())},fancySelectJs.prototype.queuePositionDropdown=function(){if(this.initialized){var t=this.select;if(null===t.offsetParent)this.hideDropdown();else{var e=this.parent,i=$(t).offset(),s=$(e).offset(),n=this.dropdownTop,l=this.dropdownLeft,o=this.dropdownWidth;e==document.body?(this.dropdownTop=i.top-s.top+$(t).outerHeight(!1)+parseInt($(e).css("marginTop")),this.dropdownLeft=i.left-s.left+parseInt($(e).css("marginLeft"))):(this.dropdownTop=i.top-s.top+$(e).scrollTop()+$(t).outerHeight(),this.dropdownLeft=i.left-s.left+$(e).scrollLeft()),this.dropdownWidth=Math.floor($(t).outerWidth(!1)),(n!=this.dropdownTop||l!=this.dropdownLeft||o!=this.dropdownWidth)&&(window.requestAnimationFrame?this.frameRequested||(window.requestAnimationFrame(this.positionDropdown.bind(this)),this.frameRequested=!0):this.positionDropdown())}}},fancySelectJs.prototype.positionDropdown=function(){this.initialized&&($(this.dropdown).css({top:this.dropdownTop,left:this.dropdownLeft}),$(this.dropdown).outerWidth(this.dropdownWidth),this.frameRequested=!1)},fancySelectJs.prototype.scrollOptionIntoView=function(t){if(this.initialized){var e=this.dropdown,i=e.children[t],s=$(i).position().top,n=$(i).innerHeight(),l=($(e).offset().top,$(e).innerHeight());0>s?e.scrollTop+=s:s+n>l&&(e.scrollTop+=s+n-l),$(i).offset().top<$(window).scrollTop()?i.scrollIntoView(!0):$(i).offset().top+$(i).innerHeight()>$(window).scrollTop()+window.innerHeight&&i.scrollIntoView(!1)}};